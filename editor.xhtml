<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:TEI="http://www.tei-c.org/ns/1.0" xmlns:bfc="http://betterform.sourceforge.net/xforms/controls" xmlns:xf="http://www.w3.org/2002/xforms" data-template="templates:surround" data-template-with="templates/page.html" data-template-at="content">
    <head>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

        <title>LGPN</title><!-- Copyright (c) 2015. existsolutions - http://www.exsitsolutions.com-->
        <link href="resources/js/vendor/select2/select2.css" rel="stylesheet"/>
        <link rel="stylesheet" type="text/css" href="resources/css/style.css"/>
    </head>
    <body>
        <div class="hidden">
            <xf:model id="model-1">
                <xf:instance xmlns="" id="i-default" src="resources/xml/teiPersonTemplate.xml"/>
                <xf:bind ref="//TEI:nym[@type ne 'Roman']/@nymRef" constraint="string-length(.) &gt; 0" type="xs:string"/>
                <xf:bind ref="//TEI:bibl[@type='primary'][index('r-primarySource')]/TEI:ref/@target" constraint="string-length(.) &gt; 0" type="xs:string"/>
                <xf:bind ref="//TEI:bibl[index('r-primarySource')]/TEI:ref/@target" constraint="string-length(.) &gt; 0" type="xs:string"/>
                <xf:bind ref="//TEI:bibl[@type='primary']/TEI:ref[index('r-primarySource')]" constraint="not(boolean-from-string(instance('i-biblPattern')/validate))"/>
                <xf:instance xmlns="" id="i-template" src="resources/xml/personTemplate.xml"/>
                <xf:instance xmlns="" id="i-volumes" src="resources/xml/volumes.xml"/>
                <xf:instance xmlns="" id="i-genders" src="resources/xml/genders.xml"/>
                <xf:instance xmlns="" id="i-personType" src="resources/xml/personType.xml"/>
                <xf:instance xmlns="" id="i-certainty" src="resources/xml/certainty.xml"/>
                <xf:instance xmlns="" id="i-datingCertainty" src="resources/xml/datingCertainty.xml"/>
                <xf:instance xmlns="" id="i-personDating" src="resources/xml/personDating.xml"/>
                <xf:instance xmlns="" id="i-dating" src="resources/xml/dating.xml"/>
                <xf:instance xmlns="" id="i-period" src="resources/xml/datingPeriod.xml"/>
                <xf:instance xmlns="" id="i-sourceTypes" src="resources/xml/sourceTypes.xml"/>
                <xf:instance xmlns="" id="i-sourceSubTypes" src="resources/xml/sourceSubTypes.xml"/>
                <xf:instance xmlns="" id="i-sources" src="resources/xml/sources.xml"/>
                <xf:instance xmlns="" id="i-names" src="resources/xml/names.xml"/>
                <xf:instance xmlns="" id="i-origins" src="resources/xml/origins.xml"/>
                <xf:instance xmlns="" id="i-places" src="resources/xml/places.xml"/>
                <xf:instance xmlns="" id="i-locations" src="resources/xml/locations.xml"/>
                <xf:instance xmlns="" id="i-relationships" src="resources/xml/relationships.xml"/>
                <xf:instance xmlns="" id="i-relationships" src="resources/xml/relationships.xml"/>
                <xf:instance xmlns="" id="i-relationshipTypes" src="resources/xml/relationshipTypes.xml"/>
                <xf:instance xmlns="" id="i-comments" src="resources/xml/comments.xml"/>
                <xf:instance xmlns="" id="i-languages" src="resources/xml/languages.xml"/>
                <xf:instance xmlns="" id="i-secondaryTypes" src="resources/xml/secondaryTypes.xml"/>
                <xf:instance xmlns="" id="i-cases" src="resources/xml/cases.xml"/>
                <xf:instance xmlns="" id="i-linking" src="resources/xml/linking.xml"/>
                <xf:instance xmlns="" id="i-biblLinking" src="resources/xml/biblLinking.xml"/>
                <xf:instance xmlns="" id="i-status" src="resources/xml/status.xml"/>
                <xf:instance xmlns="" id="i-office" src="resources/xml/office.xml"/>
                <xf:instance xmlns="" id="i-religion" src="resources/xml/religion.xml"/>
                <xf:instance xmlns="" id="i-profession" src="resources/xml/profession.xml"/>
                <xf:instance xmlns="" id="i-roman" src="resources/xml/roman.xml"/>
                <xf:instance xmlns="" id="i-other" src="resources/xml/other.xml"/>
                <xf:instance xmlns="" id="i-tribes" src="resources/xml/tribes.xml"/>
                <xf:instance xmlns="" id="i-filiation" src="resources/xml/filiation.xml"/>
                <xf:instance id="i-controller">
                    <data xmlns="">
                        <bibl/>
                        <place/>
                    </data>
                </xf:instance>
                <xf:instance id="i-biblPattern">
                    <data xmlns="">
                        <validate/>
                    </data>
                </xf:instance>
                <xf:submission id="validatePattern" method="get" replace="instance" ref="instance('i-biblPattern')" validate="false" resource="modules/validatePattern.xql?biblId={instance('i-default')//TEI:bibl[@type='primary']/TEI:ref[index('r-primarySource')]/@target}">
                    <!--<?biblId={instance('i-default')//TEI:bibl[@type='primary'][index('r-primarySource')]}">-->
                    <xf:message ev:event="xforms-submit-done" level="ephemeral">Ok.</xf:message>
                    <xf:message ev:event="xforms-submit-error">Boo.</xf:message>
                </xf:submission>
                <xf:submission id="s-load-data" method="get" replace="instance" ref="instance('i-default')" validate="false" resource="modules/load.xql?id={bf:appContext('id')}">
                    <xf:message ev:event="xforms-submit-done" level="ephemeral">Data have been
                        loaded.
                    </xf:message>
                    <xf:message ev:event="xforms-submit-error">Failed to load data.</xf:message>
                </xf:submission>
                <xf:submission id="s-save-data" method="post" replace="none" validate="true" resource="modules/save.xql">
                    <xf:action ev:event="xforms-submit"><!--
        <xf:setvalue ref="instance('i-default')//TEI:person/@xml:id" value="instance('i-default')//TEI:nym[@type='latin']"/>
        -->
                        <xf:message ev:event="xforms-submit-done" level="ephemeral">Saving...</xf:message>
                    </xf:action>
                    <xf:message ev:event="xforms-submit-done" level="ephemeral">Data have been
                        saved.
                    </xf:message>
                    <xf:message ev:event="xforms-submit-error">Failed to save data</xf:message>
                </xf:submission>
                <xf:action ev:event="xforms-ready">
                    <xf:send submission="s-load-data" if="bf:appContext('id') != ''"/>
                    <script>
                        clearAndInitAutocompletes();
                    </script>
                </xf:action>
            </xf:model>
            <xf:group id="load-subform-group">
                <xf:action ev:event="load-subform-event" if="string-length(instance('i-controller')/bibl) &gt; 0">
                    <xf:load show="embed" targetid="mountpoint">
                        <xf:resource value="concat('bibl.xhtml?bibl=', instance('i-controller')/bibl,'#xforms')"/>
                        <xf:extension includeCSS="false" includeScript="false"/>
                    </xf:load>
                    <bfc:show dialog="bibl"/>
                </xf:action>
                <xf:action ev:event="load-subform-event" if="string-length(instance('i-controller')/bibl) = 0">
                    <xf:load show="embed" targetid="mountpoint">
                        <xf:resource value="'bibl.xhtml#xforms'"/>
                        <xf:extension includeCSS="false" includeScript="false"/>
                    </xf:load>
                    <bfc:show dialog="bibl"/>
                </xf:action>
                <xf:action ev:event="load-place-subform-event" if="string-length(instance('i-controller')/place) &gt; 0">
                    <xf:load show="embed" targetid="mountpointPlace">
                        <xf:resource value="concat('place.xhtml?place=', instance('i-controller')/place,'#xforms')"/>
                        <xf:extension includeCSS="false" includeScript="false"/>
                    </xf:load>
                    <bfc:show dialog="place"/>
                </xf:action>
                <xf:action ev:event="load-place-subform-event" if="string-length(instance('i-controller')/place) = 0">
                    <xf:load show="embed" targetid="mountpointPlace">
                        <xf:resource value="'place.xhtml#xforms'"/>
                        <xf:extension includeCSS="false" includeScript="false"/>
                    </xf:load>
                    <bfc:show dialog="place"/>
                </xf:action>
            </xf:group>
        </div>

        <header>
            <div class="tp-row">
                <h1 class="tp-column-fullwidth tp-headline">LGPN Person Input Form</h1>
            </div>
        </header>

        <main>
            <!-- begin section general -->
            <section class="tp-section">
                <div class="tp-row">
                    <h2 class="tp-width-sidebar">General</h2>
                    <div class="tp-width-main">
                        <fieldset class="form-horizontal" id="general">
                            <div class="form-group">
                                <label class="tp-label-1-row-2-col">ID</label>
                                <xf:output class="tp-input-1-row-2-col -form-control" ref="//TEI:person/@xml:id">
                                    <xf:label class="input-group-addon">
                                        <i class="glyphicon glyphicon-lock"/>
                                    </xf:label>
                                    <xf:hint>id</xf:hint>
                                </xf:output>
                            </div>
                            <div class="tp-form-group-col">
                                <label class="tp-label">Volume</label>
                                <xf:select1 class="tp-input -form-control" ref="//TEI:bibl[@type='volume']/TEI:ref/@target">
                                    <xf:label class="input-group-addon">
                                        <i class="glyphicon glyphicon-book"/>
                                    </xf:label>
                                    <xf:itemset nodeset="instance('i-volumes')/option">
                                        <xf:label ref="."/>
                                        <xf:value ref="@value"/>
                                    </xf:itemset>
                                </xf:select1>
                            </div>
                            <div class="tp-form-group-col">
                                <label class="tp-label">Gender</label>
                                <xf:select1 class="tp-input -form-control" ref="//TEI:person/@sex">
                                    <xf:label class="input-group-addon">
                                        <i class="glyphicon glyphicon-user"/>
                                    </xf:label>
                                    <xf:itemset nodeset="instance('i-genders')/option">
                                        <xf:label ref="."/>
                                        <xf:value ref="@value"/>
                                    </xf:itemset>
                                </xf:select1>
                            </div>
                            <div class="tp-form-group-col">
                                <label class="tp-label">Period</label>
                                <xf:select1 class="tp-input -form-control" ref="//TEI:birth/@when">
                                    <xf:label class="input-group-addon">
                                        <i class="glyphicon glyphicon-calendar"/>
                                    </xf:label>
                                    <xf:itemset nodeset="instance('i-period')/TEI:category">
                                        <xf:label ref="./TEI:catDesc/TEI:date"/>
                                        <xf:value ref="@xml:id"/>
                                    </xf:itemset>
                                </xf:select1>
                            </div>
                            <div class="tp-form-group-col">
                                <label class="tp-label">Date</label>
                                <xf:input class="tp-input -form-control" ref="//TEI:birth/@notBefore">
                                    <xf:label class="input-group-addon">
                                        <i class="glyphicon glyphicon-calendar"/>
                                    </xf:label>

                                    <xf:hint>not before</xf:hint>
                                </xf:input>
                            </div>
                            <div class="tp-form-group-col">
                                <label class="tp-label">Person</label>
                                <div class="">
                                    <xf:select class="tp-input" ref="//TEI:birth/@ana" appearance="full">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-calendar"/>
                                        </xf:label>
                                        <xf:itemset nodeset="instance('i-personDating')//option">
                                            <xf:label ref="."/>
                                            <xf:value ref="@value"/>
                                        </xf:itemset>
                                    </xf:select>
                                </div>
                            </div>
                            <div class="tp-form-group-col">
                                <label class="tp-label">Date</label>
                                <xf:input class="tp-input -form-control" ref="//TEI:birth/@notAfter">
                                    <xf:label class="input-group-addon">
                                        <span class="glyphicon glyphicon-calendar"/>
                                    </xf:label>
                                    <xf:hint>not after</xf:hint>
                                </xf:input>
                            </div>
                            <div class="tp-form-group-col">
                                <label class="tp-label">Type</label>
                                <xf:select1 class="tp-input -form-control" ref="//TEI:person/@type">
                                    <xf:label class="input-group-addon">
                                        <i class="glyphicon glyphicon-user"/>
                                    </xf:label>
                                    <xf:itemset nodeset="instance('i-personType')/option">
                                        <xf:label ref="."/>
                                        <xf:value ref="@value"/>
                                    </xf:itemset>
                                </xf:select1>
                            </div>
                            <div class="tp-form-group-col">
                                <label class="tp-label">Certainty</label>
                                <xf:select1 class="tp-input -form-control" ref="//TEI:birth/@cert">
                                    <xf:label class="input-group-addon">
                                        <i class="glyphicon glyphicon-check"/>
                                    </xf:label>
                                    <xf:itemset nodeset="instance('i-datingCertainty')/option">
                                        <xf:label ref="."/>
                                        <xf:value ref="@value"/>
                                    </xf:itemset>
                                </xf:select1>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </section>
            <!-- // end section general -->

            <!-- begin section names -->
            <section class="tp-section">
                <div class="tp-row">
                    <h2 class="tp-width-sidebar">Names</h2>
                    <div class="tp-width-main">
                        <section class="form-horizontal" id="names">
                            <xf:group ref="//TEI:person">
                                <!-- NAMES -->
                                <div class="form-group">
                                    <label class="tp-label-1-row-2-col">Final Bracket</label>
                                    <xf:input class="tp-input-1-row-2-col -form-control" ref="TEI:persName">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-font"/>
                                        </xf:label>
                                        <xf:hint>full attested form (aka final bracket)</xf:hint>
                                    </xf:input>
                                </div>

                                <!-- NAME -->
                                <xf:group>
                                    <div class="tp-row tp-repeat-add">
                                        <xf:label class="tp-form-header">
                                            <h3>Nym</h3>
                                        </xf:label>
                                        <div class="tp-repeat-button-left">
                                            <div class="tp-button-row tp-add">
                                                <label>Add nym</label>
                                                <xf:trigger class="-btn -btn-default">
                                                    <xf:label class="input-group-addon">
                                                        <i class="glyphicon glyphicon-plus"/>
                                                    </xf:label>
                                                    <xf:insert context="instance('i-default')//TEI:listNym" nodeset="TEI:nym" origin="instance('i-template')//TEI:nym[@type!='Roman']"/>
                                                    <script>
                                                        clearAndInitAutocompletes();
                                                    </script>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </div>

                                    <xf:repeat ref="TEI:listNym/TEI:nym[@type!='Roman']" id="r-name">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Nym</h4>
                                            </xf:label>
                                        </div>

                                        <xf:group ref=".">
                                            <div class="tp-row">
                                                <div class="tp-form-group-col tp-validation">
                                                    <label class="tp-label">Select name</label>
                                                    <xf:input ref="@nymRef" class="-custom-alert">
                                                        <xf:action ev:event="nyms_autocomplete-callback">
                                                            <xf:setvalue ref="." value="event('termValue')"/>
                                                        </xf:action>
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-book"/>
                                                        </xf:label>
                                                        <xf:hint>normalized form</xf:hint>
                                                        <xf:alert>Please insert a term</xf:alert>
                                                    </xf:input>
                                                    <input type="hidden" class="tp-input" data-function="nyms_autocomplete" placeholder="Type to search name" autocomplete="off"/>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Certainty</label>
                                                    <xf:select1 class="tp-input -form-control" ref="//TEI:listNym/TEI:nym/@cert">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-check"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-certainty')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Type</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@type">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-list"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-names')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Origin</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@ana">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-flag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-origins')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Linking</label>
                                                    <xf:select1 class="tp-input -form-control" ref="TEI:seg[@type='linking']">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-link"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-linking')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                           </div>
                                            <div class="tp-row tp-repeat-buttons">
                                                <div class="tp-repeat-button-right">
                                                    <div class="tp-button-row tp-delete">
                                                        <label>Delete nym</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-trash"/>
                                                            </xf:label>
                                                            <xf:delete nodeset="instance('i-default')//TEI:listNym/TEI:nym[@type!='Roman'][index('r-name')]"/>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tp-section-divider"/>
                                        </xf:group>

                                        <!-- Attested forms -->
                                        <div>
                                            <div class="tp-row tp-repeat-add">
                                                <xf:label class="tp-form-header">
                                                    <h3>Attested Form</h3>
                                                </xf:label>
                                                <div class="tp-repeat-button-left">
                                                    <div class="tp-button-row tp-add">
                                                        <label>Add attested form</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-plus"/>
                                                            </xf:label>
                                                            <xf:insert context="instance('i-default')//TEI:nym[@type!='Roman'][index('r-name')]" nodeset="TEI:form" origin="instance('i-template')//TEI:form[@type='attested']"/>
                                                            <script>
                                                                clearAndInitAutocompletes();
                                                            </script>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>

                                            <xf:repeat ref="TEI:form[@type='attested']" id="r-nameForm">
                                                <div class="tp-row tp-repeat-headline">
                                                    <xf:label class="tp-form-header">
                                                        <h4>Attested Form</h4>
                                                    </xf:label>
                                                </div>
                                                <xf:group ref=".">
                                                    <xf:label/>
                                                </xf:group>
                                                <div class="tp-row">
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label">Attested form</label>
                                                        <xf:input class="tp-input -form-control" ref="TEI:persName">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-font"/>
                                                            </xf:label>
                                                            <xf:hint>Attested name</xf:hint>
                                                        </xf:input>
                                                    </div>
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label">Case</label>
                                                        <xf:select1 class="tp-input -form-control" ref="TEI:persName/@ana">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-pencil"/>
                                                            </xf:label>
                                                            <xf:itemset nodeset="instance('i-cases')/option">
                                                                <xf:label ref="."/>
                                                                <xf:value ref="@value"/>
                                                            </xf:itemset>
                                                        </xf:select1>
                                                    </div>
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label">Language</label>
                                                        <xf:select1 class="tp-input -form-control" ref="TEI:persName/@xml:lang">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-globe"/>
                                                            </xf:label>
                                                            <xf:itemset nodeset="instance('i-languages')/option">
                                                                <xf:label ref="."/>
                                                                <xf:value ref="@value"/>
                                                            </xf:itemset>
                                                        </xf:select1>
                                                    </div>
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label">Line</label>
                                                        <xf:input class="tp-input -form-control" ref="TEI:persName/@n">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-pencil"/>
                                                            </xf:label>
                                                            <xf:hint>line</xf:hint>
                                                        </xf:input>
                                                    </div>
                                                </div>
                                                <div class="tp-row">
                                                    <div class="form-group">
                                                        <label class="tp-label-1-row-2-col">Source</label>
                                                        <xf:select class="tp-input-1-row-2-col" ref="TEI:persName/@corresp" appearance="full">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-check"/>
                                                            </xf:label>
                                                            <xf:itemset nodeset="instance('i-sources')//option">
                                                                <xf:label ref="."/>
                                                                <xf:value ref="@value"/>
                                                            </xf:itemset>
                                                        </xf:select>
                                                    </div>
                                                </div>

                                                <div class="tp-row tp-repeat-buttons">
                                                    <div class="tp-repeat-button-right">
                                                        <div class="tp-button-row tp-delete">
                                                            <label>Delete attested form</label>
                                                            <xf:trigger class="-btn -btn-default">
                                                                <xf:label class="input-group-addon">
                                                                    <i class="glyphicon glyphicon-trash"/>
                                                                </xf:label>
                                                                <xf:delete nodeset="instance('i-default')//TEI:nym[@type!='Roman'][index('r-name')]/TEI:form[index('r-nameForm')]"/>
                                                            </xf:trigger>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="tp-section-divider"/>
                                            </xf:repeat>
                                        </div>
                                    </xf:repeat>

                                    <!-- Roman names -->
                                    <div>
                                        <div class="tp-row tp-repeat-add">
                                            <xf:label class="tp-form-header">
                                                <h3>Roman Name</h3>
                                            </xf:label>
                                            <div class="tp-repeat-button-left">
                                                <div class="tp-button-row tp-add">
                                                    <label>Add Roman name</label>
                                                    <xf:trigger class="-btn -btn-default">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-plus"/>
                                                        </xf:label>
                                                        <xf:insert context="//TEI:listNym" nodeset="TEI:nym" origin="instance('i-template')//TEI:nym[@type='Roman']"/>
                                                        <script>
                                                            clearAndInitAutocompletes();
                                                        </script>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                        </div>

                                        <xf:repeat ref="TEI:listNym/TEI:nym[@type='Roman']" id="r-rname">
                                            <div class="tp-row">
                                                <div class="tp-row tp-repeat-headline">
                                                    <xf:label class="tp-form-header">
                                                        <h4 class="col-md-6">Roman Name</h4>
                                                    </xf:label>
                                                </div>

                                                <xf:group ref=".">
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label" tooltip="ref">Praenomen</label>
                                                        <xf:input ref="TEI:persName[@type='praenomen']" class="hidden">
                                                            <xf:action ev:event="nyms_autocomplete-callback">
                                                                <xf:setvalue ref="." value="event('termValue')"/>
                                                            </xf:action>
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-book"/>
                                                            </xf:label>
                                                            <xf:hint>praenomen</xf:hint>
                                                        </xf:input>
                                                        <input type="hidden" class="tp-input" data-function="nyms_autocomplete" placeholder="Type to search praenomen" autocomplete="off"/>
                                                    </div>
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label" tooltip="ref">Nomen gentile</label>
                                                        <xf:input ref="TEI:persName[@type='nomen_gentile']" class="hidden">
                                                            <xf:action ev:event="nyms_autocomplete-callback">
                                                                <xf:setvalue ref="." value="event('termValue')"/>
                                                            </xf:action>
                                                            <xf:label class="input-group-addon">ref
                                                                <i class="glyphicon glyphicon-book"/>
                                                            </xf:label>
                                                            <xf:hint>nomen gentile</xf:hint>
                                                        </xf:input>
                                                        <input type="hidden" class="tp-input" data-function="nyms_autocomplete" placeholder="Type to search nomen gentile" autocomplete="off"/>
                                                    </div>
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label">Relationship</label>
                                                        <xf:select1 class="tp-input -form-control" ref="TEI:persName[@type='filiation']/@subtype">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-list"/>
                                                            </xf:label>
                                                            <xf:itemset nodeset="instance('i-filiation')/option">
                                                                <xf:label ref="."/>
                                                                <xf:value ref="@value"/>
                                                            </xf:itemset>
                                                        </xf:select1>
                                                    </div>
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label" tooltip="ref">Search relationship</label>
                                                        <xf:input ref="TEI:persName[@type='filiation']" class="hidden">
                                                            <xf:action ev:event="nyms_autocomplete-callback">
                                                                <xf:setvalue ref="." value="event('termValue')"/>
                                                            </xf:action>
                                                            <xf:label class="input-group-addon">ref
                                                                <i class="glyphicon glyphicon-book"/>
                                                            </xf:label>
                                                            <xf:hint>filiation</xf:hint>
                                                        </xf:input>
                                                        <input type="hidden" class="tp-input" data-function="nyms_autocomplete" placeholder="Type to search filiation" autocomplete="off"/>
                                                    </div>
                                                    <div class="tp-form-group-col">
                                                        <label class="tp-label" tooltip="ref">Tribes</label>
                                                        <xf:select1 class="tp-input -form-control" ref="TEI:persName[@type='tribe']">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-list"/>
                                                            </xf:label>
                                                            <xf:itemset nodeset="instance('i-tribes')/option">
                                                                <xf:label ref="."/>
                                                                <xf:value ref="@value"/>
                                                            </xf:itemset>
                                                        </xf:select1>
                                                    </div>
                                                </xf:group>
                                            </div>

                                            <div class="tp-row tp-repeat-buttons">
                                                <div class="tp-repeat-button-right">
                                                    <div class="tp-button-row tp-delete">
                                                        <label>Delete Roman name</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-trash"/>
                                                            </xf:label>
                                                            <xf:delete nodeset="//TEI:nym[@type='Roman'][index('r-rname')]"/>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="tp-section-divider"/>
                                        </xf:repeat>
                                    </div>

                                </xf:group>


                                <!-- Primary Sources -->
                                <xf:group>
                                    <div class="tp-row tp-repeat-add">
                                        <xf:label class="tp-form-header">
                                            <h3>Primary sources</h3>
                                        </xf:label>
                                        <div class="tp-repeat-button-left">
                                            <div class="tp-button-row tp-add">
                                                <label>Add Source</label>
                                                <xf:trigger class="-btn -btn-default">
                                                    <xf:label class="input-group-addon">
                                                        <i class="glyphicon glyphicon-plus"/>
                                                    </xf:label>
                                                    <xf:insert context="//TEI:person" nodeset="TEI:bibl" origin="instance('i-template')//TEI:bibl[@type='primary']"/>
                                                    <script>
                                                        clearAndInitAutocompletes();
                                                    </script>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </div>

                                    <xf:repeat ref="TEI:bibl[@type='primary']" id="r-primarySource">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Primary Sources</h4>
                                            </xf:label>
                                        </div>

                                        <xf:group ref=".">
                                            <xf:label/>
                                            <div class="tp-row">
                                                <div class="tp-form-group-col tp-validation">
                                                    <label class="tp-label" tooltip="ref">Reference Abbr.</label>
                                                    <xf:input class="-custom-alert" ref="TEI:ref/@target">
                                                        <xf:action ev:event="reference_autocomplete-callback">
                                                            <xf:setvalue ref="." value="event('termValue')"/>
                                                        </xf:action>
                                                        <xf:label class="input-group-addon">ref
                                                            <i class="glyphicon glyphicon-book"/>
                                                        </xf:label>
                                                        <xf:hint>reference abbreviation</xf:hint>
                                                        <xf:alert>Please insert term</xf:alert>
                                                    </xf:input>
                                                    <input type="hidden" class="tp-input" data-function="reference_autocomplete" placeholder="Type to search reference abbreviation" autocomplete="off"/>

                                                    <xf:trigger class="hidden reference_autocomplete">
                                                        <xf:label/>
                                                        <xf:action ev:event="DOMActivate">
                                                            <xf:setvalue ref="instance('i-controller')/bibl" value="instance('i-default')//TEI:bibl[@type='primary'][index('r-primarySource')]/TEI:ref/@target"/>
                                                            <xf:dispatch name="load-subform-event" targetid="load-subform-group"/>
                                                        </xf:action>
                                                    </xf:trigger>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Ref. Details</label>
                                                    <xf:input class="tp-input -form-control" ref="TEI:ref">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-list"/>
                                                        </xf:label>
                                                        <xf:hint>reference details</xf:hint>
                                                        <xf:action ev:event="xforms-value-changed">
                                                            <xf:send submission="validatePattern"/>
                                                        </xf:action>
                                                        <xf:alert>Boo</xf:alert>
                                                    </xf:input>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Category items</label>
                                                    <xf:select1 class="tp-input -form-control" ref="TEI:ref/@type">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-sourceTypes')/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Materials</label>
                                                    <xf:select1 class="tp-input -form-control" ref="TEI:ref/@subtype">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tags"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-sourceTypes')/TEI:category/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Period</label>
                                                    <xf:select1 class="tp-input -form-control" ref="TEI:date/@when">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-calendar"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-period')/TEI:category">
                                                            <xf:label ref="./TEI:catDesc/TEI:date"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Date</label>
                                                    <xf:input class="tp-input -form-control" ref="TEI:date/@notBefore">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-calendar"/>
                                                        </xf:label>
                                                        <xf:hint>not before</xf:hint>
                                                    </xf:input>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Certainty</label>
                                                    <xf:select1 class="tp-input -form-control" ref="TEI:date/@cert">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-check"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-datingCertainty')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Date</label>
                                                    <xf:input class="tp-input -form-control" ref="TEI:date/@notAfter">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-calendar"/>
                                                        </xf:label>
                                                        <xf:hint>not after</xf:hint>
                                                    </xf:input>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Linking</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@ana">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-biblLinking')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>
                                            <div class="tp-row">
                                                <div class="form-group">
                                                    <label class="tp-label-1-row-2-col">Dating</label>
                                                    <xf:select class="tp-input-1-row-2-col" ref="TEI:date/@ana" appearance="full">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-calendar"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-dating')//option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select>
                                                </div>
                                            </div>
                                        </xf:group>
                                        <div class="tp-row tp-repeat-buttons">
                                            <div class="tp-repeat-button-right">
                                                <div class="tp-button-row tp-delete">
                                                    <label>Delete Source</label>
                                                    <xf:trigger class="-btn -btn-default">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-trash"/>
                                                        </xf:label>
                                                        <xf:delete nodeset="//TEI:bibl[@type='primary'][index('r-primarySource')]"/>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tp-section-divider"/>
                                    </xf:repeat>
                                </xf:group>


                                <!-- PLACES -->
                                <xf:group>
                                    <div class="tp-row tp-repeat-add">
                                        <xf:label class="tp-form-header">
                                            <h3>Places</h3>
                                        </xf:label>
                                        <div class="tp-repeat-button-left">
                                            <div class="tp-button-row tp-add">
                                                <label>Add place</label>
                                                <xf:trigger class="-btn -btn-default ">
                                                    <xf:label class="input-group-addon">
                                                        <i class="glyphicon glyphicon-plus"/>
                                                    </xf:label>
                                                    <xf:insert context="//TEI:person" nodeset="TEI:state" origin="instance('i-template')//TEI:state[@type='location']"/>
                                                    <script>
                                                        clearAndInitAutocompletes();
                                                    </script>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </div>

                                    <xf:repeat ref="TEI:state[@type='location']" id="r-place">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Places</h4>
                                            </xf:label>
                                        </div>
                                        <xf:group ref=".">
                                            <xf:label/>
                                            <div class="tp-row">
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Place</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@subtype">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-places')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label" tooltip="ref">Search Place</label>
                                                    <xf:input class="hidden" ref="TEI:placeName/@key">
                                                        <xf:action ev:event="places_autocomplete-callback">
                                                            <xf:setvalue ref="." value="event('termValue')"/>
                                                        </xf:action>
                                                        <xf:label class="input-group-addon">ref
                                                            <i class="glyphicon glyphicon-map-marker"/>
                                                        </xf:label>
                                                        <xf:hint>place</xf:hint>
                                                    </xf:input>
                                                    <input type="hidden" class="tp-input" data-function="places_autocomplete" placeholder="Type to search place" autocomplete="off"/>

                                                    <xf:trigger class="hidden places_autocomplete">
                                                        <xf:label/>
                                                        <xf:action ev:event="DOMActivate">
                                                            <xf:setvalue ref="instance('i-controller')/place" value="instance('i-default')//TEI:state[@type='location'][index('r-place')]/TEI:placeName/@key"/>
                                                            <xf:dispatch name="load-place-subform-event" targetid="load-subform-group"/>
                                                        </xf:action>
                                                    </xf:trigger>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Reference Details</label>
                                                    <xf:select1 class="tp-input -form-control" ref="TEI:placeName/@subtype">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-pencil"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-locations')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Certainty</label>
                                                    <xf:select1 class="tp-input -form-control" ref="TEI:placeName/@cert">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-check"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-certainty')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>

                                            <div class="tp-row">
                                                <div class="form-group">
                                                    <label class="tp-label-1-row-2-col">Source</label>
                                                    <xf:select class="tp-input-1-row-2-col" ref="TEI:placeName/@corresp" appearance="full">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-check"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-sources')//option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select>
                                                </div>
                                            </div>
                                        </xf:group>
                                        <div class="tp-row tp-repeat-buttons">
                                            <div class="tp-repeat-button-right">
                                                <div class="tp-button-row tp-delete">
                                                    <label>Delete place</label>
                                                    <xf:trigger class="-btn -btn-default">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-trash"/>
                                                        </xf:label>
                                                        <xf:delete nodeset="//TEI:state[index('r-place')]"/>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tp-section-divider"/>
                                    </xf:repeat>
                                </xf:group>

                                <section class="status-section">
                                    <section class="tp-row tp-repeat-add">
                                        <xf:label class="tp-form-header">
                                            <h3 class="status-headline">Status</h3>
                                        </xf:label>
                                        <div class="tp-row status-button-container">
                                            <div class="tp-repeat-button-left">
                                                <div class="tp-button-row tp-add">
                                                    <label><span>Add </span>Status</label>
                                                    <xf:trigger class="-btn -btn-default ">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-plus"/>
                                                        </xf:label>
                                                        <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='status']"/>
                                                        <script>clearAndInitAutocompletes();</script>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                            <div class="tp-repeat-button-left">
                                                <div class="tp-button-row tp-add">
                                                    <label><span>Add </span>Profession</label>
                                                    <xf:trigger class="-btn -btn-default ">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-plus"/>
                                                        </xf:label>
                                                        <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='profession']"/>
                                                        <script>clearAndInitAutocompletes();</script>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                            <div class="tp-repeat-button-left">
                                                <div class="tp-button-row tp-add">
                                                    <label><span>Add </span>Profession</label>
                                                    <xf:trigger class="-btn -btn-default ">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-plus"/>
                                                        </xf:label>
                                                        <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='profession']"/>
                                                        <script>clearAndInitAutocompletes();</script>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                            <div class="tp-repeat-button-left">
                                                <div class="tp-button-row tp-add">
                                                    <label><span>Add </span>Office</label>
                                                    <xf:trigger class="-btn -btn-default ">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-plus"/>
                                                        </xf:label>
                                                        <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='office']"/>
                                                        <script>clearAndInitAutocompletes();</script>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                            <div class="tp-repeat-button-left">
                                                <div class="tp-button-row tp-add">
                                                    <label><span>Add </span>Religion</label>
                                                    <xf:trigger class="-btn -btn-default ">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-plus"/>
                                                        </xf:label>
                                                        <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='religion']"/>
                                                        <script>clearAndInitAutocompletes();</script>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                            <div class="tp-repeat-button-left">
                                                <div class="tp-button-row tp-add">
                                                    <label><span>Add </span>Category</label>
                                                    <xf:trigger class="-btn -btn-default ">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-plus"/>
                                                        </xf:label>
                                                        <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='Roman']"/>
                                                        <script>clearAndInitAutocompletes();</script>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                        </div>
                                    </section>

                                    <div class="tp-section-divider"/>

                                    <xf:repeat ref="//TEI:trait[@type='status']" id="r-status">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Status</h4>
                                            </xf:label>
                                        </div>

                                        <xf:group ref=".">
                                            <div class="tp-row">
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Status</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@key">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-status')/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Subcategory</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@ana">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tags"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-status')/TEI:category[@xml:id=current()/../@key]/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>

                                            <div class="tp-row tp-repeat-buttons">
                                                <div class="tp-repeat-button-right">
                                                    <div class="tp-button-row tp-delete">
                                                        <label>Delete Status</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-trash"/>
                                                            </xf:label>
                                                            <xf:delete nodeset="//TEI:trait[@type='status'][index('r-status')]"/>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>
                                        </xf:group>
                                    </xf:repeat>

                                    <div class="tp-section-divider"/>

                                    <xf:repeat ref="//TEI:trait[@type='profession']" id="r-profession">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Profession</h4>
                                            </xf:label>
                                        </div>
                                        <xf:group ref=".">
                                            <div class="tp-row">
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Profession</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@key">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-profession')/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Subcategory</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@ana">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tags"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-profession')/TEI:category[@xml:id=current()/../@key]/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>

                                            <div class="tp-row tp-repeat-buttons">
                                                <div class="tp-repeat-button-right">
                                                    <div class="tp-button-row tp-delete">
                                                        <label>Delete Profession</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-trash"/>
                                                            </xf:label>
                                                            <xf:delete nodeset="//TEI:trait[@type='profession'][index('r-profession')]"/>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>
                                        </xf:group>
                                    </xf:repeat>

                                    <div class="tp-section-divider"/>

                                    <xf:repeat ref="//TEI:trait[@type='office']" id="r-office">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Office</h4>
                                            </xf:label>
                                        </div>
                                        <xf:group ref=".">
                                            <div class="tp-row">
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Office</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@key">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-office')/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Subcategory</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@ana">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tags"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-office')/TEI:category[@xml:id=current()/../@key]/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>

                                            <div class="tp-row tp-repeat-buttons">
                                                <div class="tp-repeat-button-right">
                                                    <div class="tp-button-row tp-delete">
                                                        <label>Delete Office</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-trash"/>
                                                            </xf:label>
                                                            <xf:delete nodeset="//TEI:trait[@type='office'][index('r-office')]"/>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>

                                        </xf:group>
                                    </xf:repeat>

                                    <div class="tp-section-divider"/>

                                    <xf:repeat ref="//TEI:trait[@type='religion']" id="r-religion">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Religion</h4>
                                            </xf:label>
                                        </div>
                                        <xf:group ref=".">
                                            <div class="tp-row">
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Religion</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@key">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-religion')/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Subcategory</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@ana">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tags"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-religion')/TEI:category[@xml:id=current()/../@key]/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>

                                            <div class="tp-row tp-repeat-buttons">
                                                <div class="tp-repeat-button-right">
                                                    <div class="tp-button-row tp-delete">
                                                        <label>Delete Religion</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-trash"/>
                                                            </xf:label>
                                                            <xf:delete nodeset="//TEI:trait[@type='religion'][index('r-religion')]"/>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>
                                        </xf:group>
                                    </xf:repeat>

                                    <div class="tp-section-divider"/>

                                    <xf:repeat ref="//TEI:trait[@type='Roman']" id="r-Roman">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Roman World</h4>
                                            </xf:label>
                                        </div>
                                        <xf:group ref=".">
                                            <div class="tp-row">
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Roman World</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@key">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-roman')/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Subcategory</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@ana">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tags"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-roman')/TEI:category[@xml:id=current()/../@key]/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>

                                            <div class="tp-row tp-repeat-buttons">
                                                <div class="tp-repeat-button-right">
                                                    <div class="tp-button-row tp-delete">
                                                        <label>Delete Category</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-trash"/>
                                                            </xf:label>
                                                            <xf:delete nodeset="//TEI:trait[@type='Roman'][index('r-Roman')]"/>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>
                                        </xf:group>
                                    </xf:repeat>
                                </section>

                                <div class="tp-section-divider"/>

                                <!-- SECONDARY SOURCES -->
                                <section class="secondary-sources">
                                    <div class="tp-row tp-repeat-add">
                                        <xf:label class="tp-form-header">
                                            <h3>Secondary sources</h3>
                                        </xf:label>
                                        <div class="tp-repeat-button-left">
                                            <div class="tp-button-row tp-add">
                                                <label>Add Source</label>
                                                <xf:trigger class="-btn -btn-default">
                                                    <xf:label class="input-group-addon">
                                                        <i class="glyphicon glyphicon-plus"/>
                                                    </xf:label>
                                                    <xf:insert context="//TEI:person" nodeset="TEI:bibl" origin="instance('i-template')//TEI:bibl[@type = 'auxiliary']"/>
                                                    <script>clearAndInitAutocompletes();</script>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </div>

                                    <xf:group>
                                        <xf:repeat ref="TEI:bibl[@type = 'auxiliary']" id="r-auxiliary">
                                            <div class="tp-row tp-repeat-headline">
                                                <xf:label class="tp-form-header">
                                                    <h4>Secondary Sources</h4>
                                                </xf:label>
                                            </div>

                                            <div class="tp-row">
                                                <div class="tp-form-group-col tp-validation">
                                                    <label class="tp-label" tooltip="ref">Reference Abbr.</label>
                                                    <xf:input class="-custom-alert" ref="TEI:ref/@target">
                                                        <xf:action ev:event="reference_autocomplete-callback">
                                                            <xf:setvalue ref="." value="event('termValue')"/>
                                                        </xf:action>
                                                        <xf:label class="input-group-addon">ref
                                                            <i class="glyphicon glyphicon-search"/>
                                                        </xf:label>
                                                        <xf:hint>reference abbreviation</xf:hint>
                                                        <xf:alert>Please insert term</xf:alert>
                                                    </xf:input>
                                                    <input type="hidden" class="tp-input" data-function="reference_autocomplete" placeholder="Type to search reference abbreviation" autocomplete="off"/>
                                                    <xf:trigger class="hidden reference_autocomplete">
                                                        <xf:label/>
                                                        <xf:action ev:event="DOMActivate">
                                                            <xf:setvalue ref="instance('i-controller')/bibl" value="instance('i-default')//TEI:bibl[index('r-primarySource')]/TEI:ref/@target"/>
                                                            <xf:dispatch name="load-subform-event" targetid="load-subform-group"/>
                                                        </xf:action>
                                                    </xf:trigger>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Author</label>
                                                    <xf:input class="tp-input -form-control" ref="TEI:author">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-user"/>
                                                        </xf:label>
                                                    </xf:input>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Details</label>
                                                    <xf:input class="tp-input -form-control" ref="TEI:seg[@type='details']">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-list-alt"/>
                                                        </xf:label>
                                                    </xf:input>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Link</label>
                                                    <xf:input class="tp-input -form-control" ref="TEI:ptr/@ref">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-link"/>
                                                        </xf:label>
                                                    </xf:input>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Secondary Types</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@subtype">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-book"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-secondaryTypes')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>
                                            <div class="tp-row">
                                                <div class="form-group">
                                                    <label class="tp-label-1-row-2-col">Source</label>
                                                    <xf:select class="tp-input-1-row-2-col" ref="@ana" appearance="full">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-check"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-comments')//option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select>
                                                </div>
                                            </div>
                                            <div class="tp-row tp-repeat-buttons">
                                                <div class="tp-repeat-button-right">
                                                    <div class="tp-button-row tp-delete">
                                                        <label>Delete</label>
                                                        <xf:trigger class="-btn -btn-default">
                                                            <xf:label class="input-group-addon">
                                                                <i class="glyphicon glyphicon-trash"/>
                                                            </xf:label>
                                                            <xf:delete nodeset="//TEI:bibl[@type = 'auxiliary'][index('r-auxiliary')]"/>
                                                        </xf:trigger>
                                                    </div>
                                                </div>
                                            </div>
                                        </xf:repeat>
                                    </xf:group>
                                </section>
                                <!-- // end secondary sources -->
                            </xf:group>
                        </section>
                    </div>
                </div>
            </section>
            <!-- // end section names -->

            <!-- begin section relationships -->
            <section class="tp-section">
                <div class="tp-row">
                    <h2 class="tp-width-sidebar">Relationships</h2>
                    <div class="tp-width-main">
                        <fieldset class="form-horizontal">
                            <xf:group ref="//TEI:listRelation"><!-- RELATIONSHIPS -->
                                <xf:group class="fieldset">
                                    <div class="tp-row tp-repeat-add">
                                        <xf:label class="tp-form-header">
                                            <h3>Relationship</h3>
                                        </xf:label>
                                        <div class="tp-repeat-button-left">
                                            <div class="tp-button-row tp-add">
                                                <label>Add Relationship</label>
                                                <xf:trigger class="-btn -btn-default ">
                                                    <xf:label class="input-group-addon">
                                                        <i class="glyphicon glyphicon-plus"/>
                                                    </xf:label>
                                                    <xf:insert context="//TEI:listRelation" nodeset="TEI:relation" origin="instance('i-template')//TEI:relation"/>
                                                    <script>
                                                        clearAndInitAutocompletes();
                                                    </script>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </div>

                                    <xf:repeat ref="TEI:relation" id="r-relation">
                                        <div class="tp-row tp-repeat-headline">
                                            <xf:label class="tp-form-header">
                                                <h4>Relationship</h4>
                                            </xf:label>
                                        </div>
                                        <xf:group ref=".">
                                            <xf:label/>
                                            <div class="tp-row">
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Relationship</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@name">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-relationships')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Relationship Types</label>
                                                    <xf:select1 class="tp-input -form-control" ref="@subtype">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-tag"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-relationshipTypes')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label" tooltip="ref">Search Relative</label>
                                                    <xf:input class="hidden" ref="@passive">
                                                        <xf:action ev:event="relatives_autocomplete-callback">
                                                            <xf:setvalue ref="." value="event('termValue')"/>
                                                        </xf:action>
                                                        <xf:label class="input-group-addon">ref
                                                            <i class="glyphicon glyphicon-search"/>
                                                        </xf:label>
                                                        <xf:hint>relative</xf:hint>
                                                    </xf:input>
                                                    <input type="hidden" class="tp-input" data-function="relatives_autocomplete" placeholder="Type to search relative" autocomplete="off"/>
                                                </div>
                                                <div class="tp-form-group-col">
                                                    <label class="tp-label">Person</label>
                                                    <xf:input class="tp-input -form-control" ref=".">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-user"/>
                                                        </xf:label>
                                                        <xf:hint>person</xf:hint>
                                                    </xf:input>
                                                </div>
                                            </div>
                                        </xf:group>
                                        <div class="tp-row tp-repeat-buttons">
                                            <div class="tp-repeat-button-right">
                                                <div class="tp-button-row tp-delete">
                                                    <label>Delete Relationship</label>
                                                    <xf:trigger class="-btn -btn-default">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-trash"/>
                                                        </xf:label>
                                                        <xf:delete nodeset="//TEI:relation[index('r-relation')]"/>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                        </div>
                                    </xf:repeat>
                                </xf:group>
                            </xf:group>
                        </fieldset>
                    </div>
                </div>
            </section>
            <!-- // end section relationships -->

            <section class="tp-section tp-section-save">
                <div class="tp-row">
                    <h2 class="tp-width-sidebar">Save Form</h2>
                    <div class="tp-width-main">
                        <fieldset class="form-horizontal">

                            <div class="tp-row tp-repeat-buttons">
                                <div class="tp-repeat-button-left">
                                    <div class="tp-button-row tp-add">
                                        <label>Save form</label>
                                        <xf:submit class="-btn -btn-default" submission="s-save-data">
                                            <xf:label class="input-group-addon">
                                                <i class="glyphicon glyphicon-save"/>
                                            </xf:label>
                                        </xf:submit>
                                    </div>
                                </div>

                                <div class="tp-repeat-button-right">
                                    <div class="tp-button-row tp-delete">
                                        <label>
                                            <span>Cancel form</span>
                                            <span>Return to the list of names without saving</span>
                                        </label>
                                        <div class="tp-button-cancel">
                                            <button class="btn btn-default">
                                                <i class="glyphicon glyphicon-log-out"/>
                                                <a href="browse.html"/>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </section>

        </main>
        <bfc:dialog id="bibl" src="bibl.html">
            <xf:label>Add bibl</xf:label>
            <div id="mountpoint"/>
        </bfc:dialog>
        <bfc:dialog id="place" src="place.html">
            <xf:label>Add place</xf:label>
            <div id="mountpointPlace"/>
        </bfc:dialog>
        <script type="text/javascript" src="resources/js/jquery-1.10.2.min.js"/>
        <script type="text/javascript" src="$shared/resources/scripts/loadsource.js"/>
        <script type="text/javascript" src="resources/js/bootstrap-3.4.4.min.js"/>
        <script src="$shared/resources/scripts/jquery/jquery-ui.min.js" type="text/javascript" charset="utf-8"/>
        <script type="text/javascript" src="resources/js/editor.js"/>
        <script type="text/javascript" src="resources/js/vendor/select2/select2.js"/>
        <script type="text/javascript" src="resources/js/select2/select2.js"/>
    </body>
</html>
