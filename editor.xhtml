<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:ev="http://www.w3.org/2001/xml-events"
      xmlns:TEI="http://www.tei-c.org/ns/1.0" xmlns:bfc="http://betterform.sourceforge.net/xforms/controls"
      xmlns:xf="http://www.w3.org/2002/xforms" data-template="templates:surround"
      data-template-with="templates/page.html" data-template-at="content">
    <head>
        <meta charset="utf-8"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0"/>

        <title>LGPN</title><!-- Copyright (c) 2015. existsolutions - http://www.exsitsolutions.com-->
        <link href="resources/js/vendor/select2/select2.css" rel="stylesheet"/>
        <link rel="stylesheet" type="text/css" href="resources/css/style.css"/>
    </head>
    <body>
        <div class="hidden">
            <xf:model id="model-1">
                <xf:instance id="i-default">
                    <TEI xmlns="http://www.tei-c.org/ns/1.0">
                        <teiHeader>
                            <fileDesc>
                                <titleStmt>
                                    <title>Lexicon of Greek Personal Names</title>
                                </titleStmt>
                            </fileDesc>
                            <revisionDesc>
                                <listChange/>
                            </revisionDesc>
                        </teiHeader>
                        <text>
                            <body>
                            <listPerson><!-- @sex gender -->
                                <person xml:id="uuid" sex="" type=""><!-- LGPN volume -->
                                    <bibl type="volume">
                                        <ref target=""/>
                                    </bibl><!-- person specific dating, if derived from context or other sources --><!-- @ana to hold information about the basis of dating: literary text/era/context/paleography/typology --><!-- @cert to hold information about uncertainty -->
                                    <birth notBefore="" notBeforeEra="" notAfter="" notAfterEra="" when="" cert="high"
                                           ana=""/><!-- repeatable for every primary source -->
                                    <bibl xml:id="s1" type="primary"><!--
                                @target reference
                                @type type of source/inscription
                                @subtype subtype of source
                                -->
                                        <ref target="" type="inscr_stone" subtype=""/><!--
                                Source dating
                                @ana basis for dating: multiple choice literary text/era/context/paleography/typology
                                @notBefore @notAfter dates (year)
                                @cert to hold information about uncertainty
                                -->
                                        <date notBefore="" notBeforeEra="" notAfter="" notAfterEra="" when="" cert="high"
                                              ana=""/>
                                    </bibl>
                                    <persName type="attested"/>
                                    <listNym><!-- repeatable for all names used by a person: eg main/nickname/Roman name/patronymic/demetic (@type) --><!-- @nymRef holds normalized form of a name --><!-- @ana origin of the name e.g. Greek/Anatolian/Semitic/... Greek default -->
                                        <nym type="main" nymRef="" ana="greek" n="1"><!-- repeatable for every attested name form
                                    @xml:lang source language of the form e.g. Greek/Latin/Hebrew Greek default
                                    @ana case Nom/Gen/etc... Nom default value
                                    text content: attested form; using marks system as previously to denote conjectures etc
                                -->
                                            <seg type="linking"/>
                                            <form type="attested">
                                                <persName xml:lang="greek" ana="Nom" corresp="s1" n=""/>
                                            </form>
                                        </nym>
                                        <nym type="Roman" ana="greek" n="1"
                                             corresp="s1"><!-- special entry type for Roman names                -->
                                            <persName type="praenomen"/>
                                            <persName type="nomen_gentile"/>
                                            <persName type="filiation" subtype="son"/>
                                            <persName type="tribe"/>
                                        </nym>
                                    </listNym><!-- repeatable for @subtype: birth, residence, citizenship, attestation -->
                                    <state type="location" subtype="citizen">
                                        <placeName key="" type="ancient" subtype="" cert="high" corresp="s1"/>
                                    </state><!-- repeatable
                            @subtype: secondary, dictionary, onomastic
                            @ana: location, name, date, relationship, stemma -->
                                    <bibl type="auxiliary" subtype="secondary" ana="">
                                        <ref target=""/>
                                        <author/>
                                        <seg type="details"/>
                                        <ptr ref=""/>
                                    </bibl>
                                    <trait type="profession" key="" ana=""/>
                                    <trait type="office" key="" ana=""/>
                                    <trait type="status" key="" ana=""/>
                                    <trait type="religion" key="" ana=""/>
                                    <trait type="Roman" key="" ana=""/>
                                </person>
                                <listRelation>
                                    <relation type="family" subtype="natural" name="child" passive=""/>
                                </listRelation>
                            </listPerson>
                            </body>
                        </text>
                    </TEI>
                </xf:instance>
                <xf:bind nodeset="//TEI:nym/@nymRef" required="true()" type="xs:string"/>
                <xf:instance id="i-template">
                    <data xmlns="http://www.tei-c.org/ns/1.0"><!-- @sex gender -->
                        <person xml:id="uuid" sex="1" type=""><!-- LGPN volume -->
                            <bibl type="volume">
                                <ref target="#V5"/>
                            </bibl><!-- person specific dating, if derived from context or other sources --><!-- @ana to hold information about the basis of dating: literary text/era/context/paleography/typology --><!-- @cert to hold information about uncertainty -->
                            <birth notBefore="" notBeforeEra="" notAfter="" notAfterEra="" when="" cert="high"
                                   ana=""/><!-- repeatable for every primary source -->
                            <bibl xml:id="s2" type="primary"><!--
                                @target reference
                                @type type of source/inscription
                                @subtype subtype of source
                                -->
                                <ref target="" type="inscr_stone" subtype=""/><!--
                                Source dating
                                @ana basis for dating: multiple choice literary text/era/context/paleography/typology
                                @notBefore @notAfter dates (year)
                                @cert to hold information about uncertainty
                                -->
                                <date notBefore="" notBeforeEra="" notAfter="" notAfterEra="" when="" cert="high" ana=""/>
                            </bibl>
                            <persName type="attested"/>
                            <listNym><!-- repeatable for all names used by a person: eg main/nickname/Roman name/patronymic/demetic (@type) --><!-- @nymRef holds normalized form of a name --><!-- @ana origin of the name e.g. Greek/Anatolian/Semitic/... Greek default -->
                                <nym type="main" nymRef="" ana="greek" n="2"><!-- repeatable for every attested name form
                                    @xml:lang source language of the form e.g. Greek/Latin/Hebrew Greek default
                                    @ana case Nom/Gen/etc... Nom default value
                                    text content: attested form; using marks system as previously to denote conjectures etc
                                -->
                                    <seg type="linking"/>
                                    <form type="attested">
                                        <persName type="main" xml:lang="greek" ana="Nom" corresp="s1" n=""/>
                                    </form>
                                </nym>
                                <nym type="Roman" ana="greek" n="1"
                                     corresp="s1"><!-- special entry type for Roman names                -->
                                    <persName type="praenomen"/>
                                    <persName type="nomen_gentile"/>
                                    <persName type="filiation" subtype="son"/>
                                    <persName type="tribe"/>
                                </nym>
                            </listNym><!-- repeatable for @subtype: birth, residence, citizenship, attestation -->
                            <state type="location" subtype="citizen">
                                <placeName key="" type="ancient" subtype="" cert="high" corresp="s1"/>
                            </state><!-- repeatable
                            @subtype: secondary, dictionary, onomastic
                            @ana: location, name, date, relationship, stemma -->
                            <bibl type="auxiliary" subtype="" ana="">
                                <ref target=""/>
                                <author/>
                                <seg type="details"/>
                                <ptr ref=""/>
                            </bibl>
                            <trait type="profession" key="" ana=""/>
                            <trait type="office" key="" ana=""/>
                            <trait type="status" key="" ana=""/>
                            <trait type="religion" key="" ana=""/>
                            <trait type="Roman" key="" ana=""/>
                        </person>
                        <listRelation>
                            <relation type="family" subtype="natural" name="child" passive=""/>
                        </listRelation>
                    </data>
                </xf:instance>
                <xf:instance xmlns="" id="i-volumes" src="resources/xml/volumes.xml"/>
                <xf:instance xmlns="" id="i-genders" src="resources/xml/genders.xml"/>
                <xf:instance xmlns="" id="i-personType" src="resources/xml/personType.xml"/>
                <xf:instance xmlns="" id="i-certainty" src="resources/xml/certainty.xml"/>
                <xf:instance xmlns="" id="i-personDating" src="resources/xml/personDating.xml"/>
                <xf:instance xmlns="" id="i-dating" src="resources/xml/dating.xml"/>
                <xf:instance xmlns="" id="i-period" src="resources/xml/datingPeriod.xml"/>
                <xf:instance xmlns="" id="i-sourceTypes" src="resources/xml/sourceTypes.xml"/>
                <xf:instance xmlns="" id="i-sourceSubTypes" src="resources/xml/sourceSubTypes.xml"/>
                <xf:instance xmlns="" id="i-sources" src="resources/xml/sources.xml"/>
                <xf:instance xmlns="" id="i-names" src="resources/xml/names.xml"/>
                <xf:instance xmlns="" id="i-origins" src="resources/xml/origins.xml"/>
                <xf:instance xmlns="" id="i-places" src="resources/xml/places.xml"/>
                <xf:instance xmlns="" id="i-locations" src="resources/xml/locations.xml"/>
                <xf:instance xmlns="" id="i-relationships" src="resources/xml/relationships.xml"/>
                <xf:instance xmlns="" id="i-relationships" src="resources/xml/relationships.xml"/>
                <xf:instance xmlns="" id="i-relationshipTypes" src="resources/xml/relationshipTypes.xml"/>
                <xf:instance xmlns="" id="i-comments" src="resources/xml/comments.xml"/>
                <xf:instance xmlns="" id="i-languages" src="resources/xml/languages.xml"/>
                <xf:instance xmlns="" id="i-secondaryTypes" src="resources/xml/secondaryTypes.xml"/>
                <xf:instance xmlns="" id="i-cases" src="resources/xml/cases.xml"/>
                <xf:instance xmlns="" id="i-linking" src="resources/xml/linking.xml"/>
                <xf:instance xmlns="" id="i-status" src="resources/xml/status.xml"/>
                <xf:instance xmlns="" id="i-office" src="resources/xml/office.xml"/>
                <xf:instance xmlns="" id="i-religion" src="resources/xml/religion.xml"/>
                <xf:instance xmlns="" id="i-profession" src="resources/xml/profession.xml"/>
                <xf:instance xmlns="" id="i-roman" src="resources/xml/roman.xml"/>
                <xf:instance xmlns="" id="i-other" src="resources/xml/other.xml"/>
                <xf:instance xmlns="" id="i-tribes" src="resources/xml/tribes.xml"/>
                <xf:instance xmlns="" id="i-filiation" src="resources/xml/filiation.xml"/>
                <xf:instance id="i-controller">
                    <data xmlns="">
                        <bibl/>
                        <place/>
                    </data>
                </xf:instance>
                <xf:submission id="s-load-data" method="get" replace="instance" ref="instance('i-default')" validate="false"
                               resource="modules/load.xql?id={bf:appContext('id')}">
                    <xf:message ev:event="xforms-submit-done" level="ephemeral">Data have been
                        loaded.
                    </xf:message>
                    <xf:message ev:event="xforms-submit-error">Failed to load data.</xf:message>
                </xf:submission>
                <xf:submission id="s-save-data" method="post" replace="none" validate="true" resource="modules/save.xql">
                    <xf:action ev:event="xforms-submit"><!--
        <xf:setvalue ref="instance('i-default')//TEI:person/@xml:id" value="instance('i-default')//TEI:nym[@type='latin']"/>
        -->
                        <xf:message ev:event="xforms-submit-done" level="ephemeral">Saving...</xf:message>
                    </xf:action>
                    <xf:message ev:event="xforms-submit-done" level="ephemeral">Data have been
                        saved.
                    </xf:message>
                    <xf:message ev:event="xforms-submit-error">Failed to save data</xf:message>
                </xf:submission>
                <xf:action ev:event="xforms-ready">
                    <xf:send submission="s-load-data" if="bf:appContext('id') != ''"/>
                    <script>
                        clearAndInitAutocompletes();
                    </script>
                </xf:action>
            </xf:model>
            <xf:group id="load-subform-group">
                <xf:action ev:event="load-subform-event" if="string-length(instance('i-controller')/bibl) &gt; 0">
                    <xf:load show="embed" targetid="mountpoint">
                        <xf:resource value="concat('bibl.xhtml?bibl=', instance('i-controller')/bibl,'#xforms')"/>
                        <xf:extension includeCSS="false" includeScript="false"/>
                    </xf:load>
                    <bfc:show dialog="bibl"/>
                </xf:action>
                <xf:action ev:event="load-subform-event" if="string-length(instance('i-controller')/bibl) = 0">
                    <xf:load show="embed" targetid="mountpoint">
                        <xf:resource value="'bibl.xhtml#xforms'"/>
                        <xf:extension includeCSS="false" includeScript="false"/>
                    </xf:load>
                    <bfc:show dialog="bibl"/>
                </xf:action>
                <xf:action ev:event="load-place-subform-event" if="string-length(instance('i-controller')/place) &gt; 0">
                    <xf:load show="embed" targetid="mountpointPlace">
                        <xf:resource value="concat('place.xhtml?place=', instance('i-controller')/place,'#xforms')"/>
                        <xf:extension includeCSS="false" includeScript="false"/>
                    </xf:load>
                    <bfc:show dialog="place"/>
                </xf:action>
                <xf:action ev:event="load-place-subform-event" if="string-length(instance('i-controller')/place) = 0">
                    <xf:load show="embed" targetid="mountpointPlace">
                        <xf:resource value="'place.xhtml#xforms'"/>
                        <xf:extension includeCSS="false" includeScript="false"/>
                    </xf:load>
                    <bfc:show dialog="place"/>
                </xf:action>
            </xf:group>
        </div>

        <header>
            <div class="tp-row">
                <h1 class="tp-column-fullwidth tp-headline">LGPN Person Input Form</h1>
            </div>
        </header>

        <main>
            <!-- begin section general -->
            <section class="tp-section">
                <div class="tp-row">
                    <h2 class="tp-width-sidebar">General</h2>
                    <div class="tp-width-main">
                        <fieldset class="form-horizontal" id="general">
                            <div class="tp-row">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">ID</label>
                                    <xf:output class="input-group col-sm-8 -form-control" ref="//TEI:person/@xml:id">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-lock"/>
                                        </xf:label>
                                        <xf:hint>id</xf:hint>
                                    </xf:output>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">Gender</label>
                                    <xf:select1 class="input-group col-sm-8 -form-control" ref="//TEI:person/@sex">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-user"/>
                                        </xf:label>
                                        <xf:itemset nodeset="instance('i-genders')/option">
                                            <xf:label ref="."/>
                                            <xf:value ref="@value"/>
                                        </xf:itemset>
                                    </xf:select1>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">Type</label>
                                    <xf:select1 class="input-group col-sm-8 -form-control" ref="//TEI:person/@type">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-user"/>
                                        </xf:label>
                                        <xf:itemset nodeset="instance('i-personType')/option">
                                            <xf:label ref="."/>
                                            <xf:value ref="@value"/>
                                        </xf:itemset>
                                    </xf:select1>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">Volume</label>
                                    <xf:select1 class="input-group col-sm-8 -form-control" ref="//TEI:bibl[@type='volume']/TEI:ref/@target">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-book"/>
                                        </xf:label>
                                        <xf:itemset nodeset="instance('i-volumes')/option">
                                            <xf:label ref="."/>
                                            <xf:value ref="@value"/>
                                        </xf:itemset>
                                    </xf:select1>
                                </div>
                            </div>
                            <div class="tp-row">
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">Period</label>
                                    <xf:select1 class="input-group col-sm-8 -form-control" ref="//TEI:birth/@when">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-calendar"/>
                                        </xf:label>
                                        <xf:itemset nodeset="instance('i-period')/option">
                                            <xf:label ref="."/>
                                            <xf:value ref="@value"/>
                                        </xf:itemset>
                                    </xf:select1>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">Date</label>
                                    <xf:input class="input-group col-sm-8 -form-control" ref="//TEI:birth/@notBefore">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-calendar"/>
                                        </xf:label>
                                        <xf:hint>not before</xf:hint>
                                    </xf:input>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">Date</label>
                                    <xf:input class="input-group col-sm-8 -form-control" ref="//TEI:birth/@notAfter">
                                        <xf:label class="input-group-addon">
                                            <span class="glyphicon glyphicon-calendar"/>
                                        </xf:label>
                                        <xf:hint>not after</xf:hint>
                                    </xf:input>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">Check</label>
                                    <xf:select1 class="input-group col-sm-8 -form-control" ref="//TEI:birth/@cert">
                                        <xf:label class="input-group-addon">
                                            <i class="glyphicon glyphicon-check"/>
                                        </xf:label>
                                        <xf:itemset nodeset="instance('i-certainty')/option">
                                            <xf:label ref="."/>
                                            <xf:value ref="@value"/>
                                        </xf:itemset>
                                    </xf:select1>
                                </div>
                                <div class="form-group">
                                    <label class="col-sm-2 control-label">Person</label>
                                    <div class="">
                                        <xf:select class="input-group col-sm-8" ref="//TEI:birth/@ana" appearance="full">
                                            <xf:label class="input-group-addon">
                                                <i class="glyphicon glyphicon-calendar"/>
                                            </xf:label>
                                            <xf:itemset nodeset="instance('i-personDating')//option">
                                                <xf:label ref="."/>
                                                <xf:value ref="@value"/>
                                            </xf:itemset>
                                        </xf:select>
                                    </div>
                                </div>
                            </div>
                        </fieldset>
                    </div>
                </div>
            </section>
            <!-- // end section general -->

            <!-- begin section names -->
            <section class="tp-section">
                <div class="tp-row">
                    <h2 class="tp-width-sidebar">Names</h2>
                    <div class="tp-width-main">
                        <section class="form-horizontal" id="names">
                            <xf:group ref="//TEI:person"><!-- NAMES -->
                                <!-- NAME -->
                                <xf:group>
                                    <xf:label class="tp-row tp-form-header">
                                        <h4 class="col-xs-2">Name</h4>
                                    </xf:label>

                                    <div class="tp-row">
                                        <div class="form-group">
                                            <label class="col-sm-2 control-label">Final Bracket</label>
                                            <xf:input class="input-group col-sm-8 -form-control" ref="TEI:persName">
                                                <xf:label class="input-group-addon">
                                                    <i class="glyphicon glyphicon-font"/>
                                                </xf:label>
                                                <xf:hint>full attested form (aka final bracket)</xf:hint>
                                            </xf:input>
                                        </div>
                                    </div>

                                    <div class="tp-row">
                                        <div class="form-group">
                                            <xf:repeat ref="TEI:listNym/TEI:nym[@type!='Roman']" id="r-name">
                                                <xf:label/>
                                                <xf:group ref=".">
                                                    <xf:label/>
                                                    <div class="tp-row">
                                                        <div class="form-group">
                                                            <label class="col-sm-2 control-label">Search name</label>
                                                                <xf:input ref="@nymRef" class="hidden">
                                                                    <xf:action ev:event="nyms_autocomplete-callback">
                                                                        <xf:setvalue ref="." value="event('termValue')"/>
                                                                    </xf:action>
                                                                    <xf:label class="input-group-addon">
                                                                        <i class="glyphicon glyphicon-book"/>
                                                                    </xf:label>
                                                                    <xf:hint>normalized form</xf:hint>
                                                                </xf:input>
                                                            <input type="hidden" class="input-group col-sm-8" data-function="nyms_autocomplete" placeholder="Type to search ..." autocomplete="off"/>
                                                        </div>
                                                    </div>
                                                    <div class="tp-row">
                                                        <div class="form-group">
                                                            <label class="col-sm-2 control-label">Type of Name</label>
                                                            <xf:select1 class="col-sm-8 input-group -form-control" ref="@type">
                                                                <xf:label class="input-group-addon">
                                                                    <i class="glyphicon glyphicon-list"/>
                                                                </xf:label>
                                                                <xf:itemset nodeset="instance('i-names')/option">
                                                                    <xf:label ref="."/>
                                                                    <xf:value ref="@value"/>
                                                                </xf:itemset>
                                                            </xf:select1>
                                                        </div>
                                                    </div>
                                                    <div class="tp-row">
                                                        <div class="form-group">
                                                            <label class="col-sm-2 control-label">Origin of name</label>
                                                            <xf:select1 class="input-group -form-control col-sm-8" ref="@ana">
                                                                <xf:label class="input-group-addon">
                                                                    <i class="glyphicon glyphicon-flag"/>
                                                                </xf:label>
                                                                <xf:itemset nodeset="instance('i-origins')/option">
                                                                    <xf:label ref="."/>
                                                                    <xf:value ref="@value"/>
                                                                </xf:itemset>
                                                            </xf:select1>
                                                        </div>
                                                    </div>
                                                    <div class="tp-row">
                                                        <div class="form-group">
                                                            <label class="col-sm-2 control-label">Linking</label>
                                                            <xf:select1 class="input-group -form-control col-sm-8" ref="TEI:seg[@type='linking']">
                                                                <xf:label class="input-group-addon">
                                                                    <i class="glyphicon glyphicon-link"/>
                                                                </xf:label>
                                                                <xf:itemset nodeset="instance('i-linking')/option">
                                                                    <xf:label ref="."/>
                                                                    <xf:value ref="@value"/>
                                                                </xf:itemset>
                                                            </xf:select1>
                                                        </div>
                                                    </div>

                                                    <div class="tp-repeat-buttons">
                                                        <div class="tp-row">
                                                            <div class="tp-button-row tp-delete">
                                                                <label class="col-sm-2 control-label">Delete name</label>
                                                                <xf:trigger class="-btn -btn-default">
                                                                    <xf:label class="input-group-addon">
                                                                        <i class="glyphicon glyphicon-trash"/>
                                                                    </xf:label>
                                                                    <xf:delete nodeset="//TEI:nym[index('r-name')]"/>
                                                                </xf:trigger>
                                                            </div>
                                                        </div>
                                                        <div class="tp-row">
                                                            <div class="tp-button-row tp-add">
                                                                <label class="col-sm-2 control-label">Add name</label>
                                                                <xf:trigger class="-btn -btn-default">
                                                                    <xf:label class="input-group-addon">
                                                                        <i class="glyphicon glyphicon-plus"/>
                                                                    </xf:label>
                                                                    <xf:insert context="//TEI:listNym" nodeset="TEI:nym" origin="instance('i-template')//TEI:nym[@type!='Roman']"/>
                                                                    <script>
                                                                        clearAndInitAutocompletes();
                                                                    </script>
                                                                </xf:trigger>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="tp-divider col-xs-12"></div>

                                                    <div class="tp-row">
                                                        <!-- Attested forms -->
                                                        <xf:repeat ref="TEI:form[@type='attested']" id="r-nameForm">
                                                            <xf:label class="tp-row tp-form-header">
                                                                <h4 class="col-xs-2">Attested Form</h4>
                                                            </xf:label>
                                                            <xf:group ref=".">
                                                                <xf:label/>
                                                            </xf:group>
                                                            <div class="form-group">
                                                                <div class="tp-row">
                                                                    <div class="form-group">
                                                                        <label class="col-sm-2 control-label">Attested form</label>
                                                                        <xf:input class="col-sm-8 input-group -form-control" ref="TEI:persName">
                                                                            <xf:label class="input-group-addon">
                                                                                <i class="glyphicon glyphicon-font"/>
                                                                            </xf:label>
                                                                            <xf:hint>Attested name</xf:hint>
                                                                        </xf:input>
                                                                    </div>
                                                                </div>
                                                                <div class="tp-row">
                                                                    <div class="form-group">
                                                                        <label class="col-sm-2 control-label">Casus</label>
                                                                        <xf:select1 class="input-group col-sm-8 -form-control" ref="TEI:persName/@ana">
                                                                            <xf:label class="input-group-addon">
                                                                                <i class="glyphicon glyphicon-pencil"/>
                                                                            </xf:label>
                                                                            <xf:itemset nodeset="instance('i-cases')/option">
                                                                                <xf:label ref="."/>
                                                                                <xf:value ref="@value"/>
                                                                            </xf:itemset>
                                                                        </xf:select1>
                                                                    </div>
                                                                </div>
                                                                <div class="tp-row">
                                                                    <div class="form-group">
                                                                        <label class="col-sm-2 control-label">Languages</label>
                                                                        <xf:select1 class="input-group col-sm-8 -form-control" ref="TEI:persName/@xml:lang">
                                                                            <xf:label class="input-group-addon">
                                                                                <i class="glyphicon glyphicon-globe"/>
                                                                            </xf:label>
                                                                            <xf:itemset nodeset="instance('i-languages')/option">
                                                                                <xf:label ref="."/>
                                                                                <xf:value ref="@value"/>
                                                                            </xf:itemset>
                                                                        </xf:select1>
                                                                    </div>
                                                                </div>
                                                                <div class="tp-row">
                                                                    <div class="form-group">
                                                                        <label class="col-sm-2 control-label">Line</label>
                                                                        <xf:input class="col-sm-8 input-group -form-control" ref="TEI:persName/@n">
                                                                            <xf:label class="input-group-addon">
                                                                                <i class="glyphicon glyphicon-pencil"/>
                                                                            </xf:label>
                                                                            <xf:hint>line</xf:hint>
                                                                        </xf:input>
                                                                    </div>
                                                                </div>
                                                                <div class="tp-row">
                                                                    <div class="form-group">
                                                                        <label class="col-sm-2 control-label">Source</label>
                                                                        <xf:select class="input-group col-sm-8" ref="TEI:persName/@corresp" appearance="full">
                                                                            <xf:label class="input-group-addon">
                                                                                <i class="glyphicon glyphicon-check"/>
                                                                            </xf:label>
                                                                            <xf:itemset nodeset="instance('i-sources')//option">
                                                                                <xf:label ref="."/>
                                                                                <xf:value ref="@value"/>
                                                                            </xf:itemset>
                                                                        </xf:select>
                                                                    </div>
                                                                </div>

                                                            </div>
                                                        </xf:repeat>

                                                        <div class="tp-repeat-buttons">
                                                            <div class="tp-row">
                                                                <div class="tp-button-row tp-delete">
                                                                    <label class="col-sm-2 control-label">Delete attested form</label>
                                                                    <xf:trigger class="-btn -btn-default">
                                                                        <xf:label class="input-group-addon">
                                                                            <i class="glyphicon glyphicon-trash"/>
                                                                        </xf:label>
                                                                        <xf:delete nodeset="//TEI:nym[@type!='Roman'][index('r-name')]/TEI:form[index('r-nameForm')]"/>
                                                                    </xf:trigger>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="tp-row">
                                                            <div class="tp-button-row tp-add">
                                                                <label class="col-sm-2 control-label">Add attested form</label>
                                                                <xf:trigger class="-btn -btn-default">
                                                                    <xf:label class="input-group-addon">
                                                                        <i class="glyphicon glyphicon-plus"/>
                                                                    </xf:label>
                                                                    <xf:insert context="//TEI:nym[@type!='Roman'][index('r-name')]" nodeset="TEI:form" origin="instance('i-template')//TEI:form[@type='attested']"/>
                                                                    <script>
                                                                        clearAndInitAutocompletes();
                                                                    </script>
                                                                </xf:trigger>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="tp-divider col-xs-12"></div>

                                                </xf:group>
                                            </xf:repeat>
                                        </div>
                                    </div>

                                    <!-- Roman names -->
                                    <xf:repeat ref="TEI:listNym/TEI:nym[@type='Roman']" id="r-rname">
                                        <xf:label class="tp-row tp-form-header">
                                            <h4 class="col-xs-2">Roman Name</h4>
                                        </xf:label>

                                        <xf:group ref=".">
                                            <xf:label/>
                                            <div class="tp-row">
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label" tooltip="ref">Praenomen</label>
                                                    <xf:input ref="TEI:persName[@type='praenomen']" class="hidden">
                                                        <xf:action ev:event="nyms_autocomplete-callback">
                                                            <xf:setvalue ref="." value="event('termValue')"/>
                                                        </xf:action>
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-book"/>
                                                        </xf:label>
                                                        <xf:hint>praenomen</xf:hint>
                                                    </xf:input>

                                                    <input type="hidden" class="input-group col-sm-8" data-function="nyms_autocomplete" placeholder="praenomen" autocomplete="off"/>
                                                </div>
                                             </div>

                                            <div class="tp-row">
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label" tooltip="ref">Nomen gentile</label>
                                                    <xf:input ref="TEI:persName[@type='nomen_gentile']" class="hidden">
                                                        <xf:action ev:event="nyms_autocomplete-callback">
                                                            <xf:setvalue ref="." value="event('termValue')"/>
                                                        </xf:action>
                                                        <xf:label class="input-group-addon">ref
                                                            <i class="glyphicon glyphicon-book"/>
                                                        </xf:label>
                                                        <xf:hint>nomen gentile</xf:hint>
                                                    </xf:input>
                                                    <input type="hidden" class="input-group col-sm-8" data-function="nyms_autocomplete" placeholder="n. gentile" autocomplete="off"/>
                                                </div>
                                            </div>
                                            <div class="tp-row">
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label">Filiation</label>
                                                    <xf:select1 class="input-group col-sm-8 -form-control" ref="TEI:persName[@type='filiation']/@subtype">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-list"/>
                                                        </xf:label>

                                                        <xf:itemset nodeset="instance('i-filiation')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>
                                            <div class="tp-row">
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label" tooltip="ref">Search filiation</label>
                                                    <xf:input ref="TEI:persName[@type='filiation']" class="hidden">
                                                        <xf:action ev:event="nyms_autocomplete-callback">
                                                            <xf:setvalue ref="." value="event('termValue')"/>
                                                        </xf:action>
                                                        <xf:label class="input-group-addon">ref
                                                            <i class="glyphicon glyphicon-book"/>
                                                        </xf:label>
                                                        <xf:hint>filiation</xf:hint>
                                                    </xf:input>
                                                    <input type="hidden" class="input-group col-sm-8" data-function="nyms_autocomplete" placeholder="filiation" autocomplete="off"/>
                                                </div>
                                            </div>

                                            <div class="tp-row">
                                                <div class="form-group">
                                                    <label class="col-sm-2 control-label" tooltip="ref">Tribes</label>
                                                    <xf:select1 class="input-group col-sm-8 -form-control" ref="TEI:persName[@type='tribe']">
                                                        <xf:label class="input-group-addon">
                                                            <i class="glyphicon glyphicon-list"/>
                                                        </xf:label>
                                                        <xf:itemset nodeset="instance('i-tribes')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>

                                        </xf:group>
                                    </xf:repeat>

                                    <div class="tp-repeat-buttons">
                                        <div class="tp-row">
                                            <div class="tp-button-row tp-delete">
                                                <label class="col-sm-2 control-label">Delete Roman name</label>
                                                <xf:trigger class="-btn -btn-default">
                                                    <xf:label class="input-group-addon">
                                                        <i class="glyphicon glyphicon-trash"/>
                                                    </xf:label>
                                                    <xf:delete nodeset="//TEI:nym[index('r-rname')]"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                        <div class="tp-row">
                                            <div class="tp-button-row tp-add">
                                                <label class="col-sm-2 control-label">Add Roman name</label>
                                                <xf:trigger class="-btn -btn-default">
                                                    <xf:label class="input-group-addon">
                                                        <i class="glyphicon glyphicon-plus"/>
                                                    </xf:label>
                                                    <xf:insert context="//TEI:listNym" nodeset="TEI:nym" origin="instance('i-template')//TEI:nym[@type='Roman']"/>
                                                    <script>
                                                        clearAndInitAutocompletes();
                                                    </script>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </div>
                                </xf:group>

                                <div class="tp-section-divider"></div>

                                <!-- Primary Sources -->
                                <xf:group class="fieldset">
                                    <xf:label>
                                        <h3>Primary sources</h3>
                                    </xf:label>
                                    <xf:repeat ref="TEI:bibl[@type='primary']" id="r-primarySource">
                                        <xf:label/>
                                        <xf:group ref=".">
                                            <xf:label/>
                                            <div class="row">
                                                <div class="col-xs-2">
                                                    <div class="input-group">
                                                        <label class="input-group-addon glyphicon glyphicon-book" tooltip="ref"/>
                                                        <div>
                                                            <xf:input class="-input-group --form-control hidden" ref="TEI:ref/@target">
                                                                <xf:action ev:event="reference_autocomplete-callback">
                                                                    <xf:setvalue ref="." value="event('termValue')"/>
                                                                </xf:action>
                                                                <xf:label class="input-group-addon -glyphicon -glyphicon-book">ref</xf:label>
                                                                <xf:hint>reference abbreviation</xf:hint>
                                                            </xf:input>
                                                            <input type="hidden" data-function="reference_autocomplete" placeholder="Type to search ..." autocomplete="off"/>
                                                        </div>
                                                    </div>
                                                    <xf:trigger class="hidden reference_autocomplete">
                                                        <xf:label/>
                                                        <xf:action ev:event="DOMActivate">
                                                            <xf:setvalue ref="instance('i-controller')/bibl" value="instance('i-default')//TEI:bibl[index('r-primarySource')]/TEI:ref/@target"/>
                                                            <xf:dispatch name="load-subform-event" targetid="load-subform-group"/>
                                                        </xf:action>
                                                    </xf:trigger>
                                                </div>
                                                <div class="col-xs-2">
                                                    <xf:input class="input-group -form-control" ref="TEI:ref">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-list"/>
                                                        <xf:hint>reference details</xf:hint>
                                                    </xf:input>
                                                </div>
                                                <div class="col-xs-2">
                                                    <xf:select1 class="input-group -form-control" ref="TEI:ref/@type">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-tag"/>
                                                        <xf:itemset nodeset="instance('i-sourceTypes')/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="col-xs-2">
                                                    <xf:select1 class="input-group -form-control" ref="TEI:ref/@subtype">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-tags"/>
                                                        <xf:itemset nodeset="instance('i-sourceTypes')/TEI:category/TEI:category">
                                                            <xf:label ref="TEI:catDesc"/>
                                                            <xf:value ref="@xml:id"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="col-xs-2">
                                                    <xf:select1 class="input-group -form-control" ref="TEI:ref/TEI:seg/@type">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-tags"/>
                                                        <xf:itemset nodeset="instance('i-other')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="col-xs-2">
                                                    <xf:input class="input-group -form-control" ref="TEI:ref/TEI:seg">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-edit"/>
                                                        <xf:hint>reading</xf:hint>
                                                    </xf:input>
                                                </div>
                                            </div>
                                            <br/>
                                            <div class="row">
                                                <div class="col-xs-4">
                                                    <xf:input class="input-group -form-control" ref="TEI:date/@notBefore">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-calendar"/>
                                                        <xf:hint>not before</xf:hint>
                                                    </xf:input>
                                                </div>
                                                <div class="col-xs-4">
                                                    <xf:input class="input-group -form-control" ref="TEI:date/@notAfter">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-calendar"/>
                                                        <xf:hint>not after</xf:hint>
                                                    </xf:input>
                                                </div>
                                                <div class="col-xs-4">
                                                    <xf:select1 class="input-group -form-control" ref="TEI:date/@cert">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-check"/>
                                                        <xf:itemset nodeset="instance('i-certainty')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-11">
                                                    <div class="input-group">
                                                        <xf:select class="input-group -form-control" ref="TEI:date/@ana" appearance="full">
                                                            <xf:label class="input-group-addon">dating</xf:label>
                                                            <xf:itemset nodeset="instance('i-dating')//option">
                                                                <xf:label ref="."/>
                                                                <xf:value ref="@value"/>
                                                            </xf:itemset>
                                                        </xf:select>
                                                    </div>
                                                </div>
                                                <div class="col-xs-1">
                                                    <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                        <xf:label/>
                                                        <xf:delete nodeset="//TEI:bibl[@type='primary'][index('r-primarySource')]"/>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                        </xf:group>
                                    </xf:repeat>
                                    <div class="row">
                                        <div class="col-xs-11"/>
                                        <div class="col-xs-1">
                                            <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                                <xf:label/>
                                                <xf:insert context="//TEI:person" nodeset="TEI:bibl" origin="instance('i-template')//TEI:bibl[@type='primary']"/>
                                            </xf:trigger>
                                        </div>
                                    </div>
                                </xf:group>

                                <div class="tp-section-divider"></div>

                                <!-- PLACES -->
                                <xf:group class="fieldset">
                                    <xf:label>
                                        <h3>Places</h3>
                                    </xf:label>
                                    <xf:repeat ref="TEI:state[@type='location']" id="r-place">
                                        <xf:label/>
                                        <xf:group ref=".">
                                            <xf:label/>
                                            <div class="row">
                                                <div class="col-xs-3">
                                                    <xf:select1 class="input-group -form-control" ref="@subtype">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-tag"/>
                                                        <xf:itemset nodeset="instance('i-places')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="col-xs-3">
                                                    <div class="input-group">
                                                        <label class="input-group-addon glyphicon glyphicon-map-marker" tooltip="ref"/>
                                                        <div>
                                                            <xf:input class="-input-group --form-control hidden" ref="TEI:placeName/@key">
                                                                <xf:action ev:event="places_autocomplete-callback">
                                                                    <xf:setvalue ref="." value="event('termValue')"/>
                                                                </xf:action>
                                                                <xf:label class="input-group-addon -glyphicon -glyphicon-book">ref</xf:label>
                                                                <xf:hint>place</xf:hint>
                                                            </xf:input>
                                                            <input type="hidden" data-function="places_autocomplete" placeholder="Type to search ..." autocomplete="off"/>
                                                            <xf:trigger class="hidden places_autocomplete">
                                                                <xf:label/>
                                                                <xf:action ev:event="DOMActivate">
                                                                    <xf:setvalue ref="instance('i-controller')/place" value="instance('i-default')//TEI:state[@type='location'][index('r-place')]/TEI:placeName/@key"/>
                                                                    <xf:dispatch name="load-place-subform-event" targetid="load-subform-group"/>
                                                                </xf:action>
                                                            </xf:trigger>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-xs-2">
                                                    <xf:select1 class="input-group -form-control" ref="TEI:placeName/@subtype">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-pencil"/>
                                                        <xf:itemset nodeset="instance('i-locations')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                                <div class="col-xs-3">
                                                    <xf:select1 class="input-group -form-control" ref="TEI:placeName/@cert">
                                                        <xf:label class="input-group-addon glyphicon glyphicon-check"/>
                                                        <xf:itemset nodeset="instance('i-certainty')/option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select1>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-xs-11">
                                                    <div class="input-group">
                                                        <xf:select class="input-group -form-control" ref="TEI:placeName/@corresp" appearance="full">
                                                            <xf:label class="input-group-addon">source</xf:label>
                                                            <xf:itemset nodeset="instance('i-sources')//option">
                                                                <xf:label ref="."/>
                                                                <xf:value ref="@value"/>
                                                            </xf:itemset>
                                                        </xf:select>
                                                    </div>
                                                </div>
                                                <div class="col-xs-1">
                                                    <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                        <xf:label/>
                                                        <xf:delete nodeset="//TEI:state[index('r-place')]"/>
                                                    </xf:trigger>
                                                </div>
                                            </div>
                                        </xf:group>
                                    </xf:repeat>
                                    <div class="row">
                                        <div class="col-xs-11"/>
                                        <div class="col-xs-1">
                                            <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                                <xf:label/>
                                                <xf:insert context="//TEI:person" nodeset="TEI:state" origin="instance('i-template')//TEI:state[@type='location']"/>
                                            </xf:trigger>
                                        </div>
                                    </div>
                                </xf:group>

                                <div class="tp-section-divider"></div>

                                <h3>Status</h3>
                                <xf:repeat ref="//TEI:trait[@type='status']" id="r-status">
                                    <xf:label/>
                                    <xf:group ref=".">
                                        <div class="row">
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@key">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tag">status</xf:label>
                                                    <xf:itemset nodeset="instance('i-status')/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@ana">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tags"/>
                                                    <xf:itemset nodeset="instance('i-status')/TEI:category/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                    <xf:label/>
                                                    <xf:delete nodeset="//TEI:trait[@type='status'][index('r-status')]"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-11"/>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                                    <xf:label/>
                                                    <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='status']"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </xf:group>
                                </xf:repeat>

                                <xf:repeat ref="//TEI:trait[@type='profession']" id="r-profession">
                                    <xf:label/>
                                    <xf:group ref=".">
                                        <div class="row">
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@key">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tag">profession</xf:label>
                                                    <xf:itemset nodeset="instance('i-profession')/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@ana">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tags"/>
                                                    <xf:itemset nodeset="instance('i-profession')/TEI:category/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                    <xf:label/>
                                                    <xf:delete nodeset="//TEI:trait[@type='profession'][index('r-profession')]"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-11"/>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                                    <xf:label/>
                                                    <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='profession']"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </xf:group>
                                </xf:repeat>

                                <xf:repeat ref="//TEI:trait[@type='office']" id="r-office">
                                    <xf:label/>
                                    <xf:group ref=".">
                                        <div class="row">
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@key">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tag">office</xf:label>
                                                    <xf:itemset nodeset="instance('i-office')/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@ana">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tags"/>
                                                    <xf:itemset nodeset="instance('i-office')/TEI:category/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                    <xf:label/>
                                                    <xf:delete nodeset="//TEI:trait[@type='office'][index('r-office')]"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-11"/>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                                    <xf:label/>
                                                    <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='office']"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </xf:group>
                                </xf:repeat>

                                <xf:repeat ref="//TEI:trait[@type='religion']" id="r-religion">
                                    <xf:label/>
                                    <xf:group ref=".">
                                        <div class="row">
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@key">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tag">religion</xf:label>
                                                    <xf:itemset nodeset="instance('i-religion')/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@ana">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tags"/>
                                                    <xf:itemset nodeset="instance('i-religion')/TEI:category/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                    <xf:label/>
                                                    <xf:delete nodeset="//TEI:trait[@type='religion'][index('r-religion')]"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-11"/>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                                    <xf:label/>
                                                    <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='religion']"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </xf:group>
                                </xf:repeat>

                                <xf:repeat ref="//TEI:trait[@type='Roman']" id="r-Roman">
                                    <xf:label/>
                                    <xf:group ref=".">
                                        <div class="row">
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@key">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tag">Roman world</xf:label>
                                                    <xf:itemset nodeset="instance('i-roman')/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-4">
                                                <xf:select1 class="input-group -form-control" ref="@ana">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tags"/>
                                                    <xf:itemset nodeset="instance('i-roman')/TEI:category/TEI:category">
                                                        <xf:label ref="TEI:catDesc"/>
                                                        <xf:value ref="@xml:id"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                    <xf:label/>
                                                    <xf:delete nodeset="//TEI:trait[@type='Roman'][index('r-Roman')]"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-11"/>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                                    <xf:label/>
                                                    <xf:insert context="//TEI:person" nodeset="TEI:trait" origin="instance('i-template')//TEI:trait[@type='Roman']"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </xf:group>
                                </xf:repeat>

                                <div class="tp-section-divider"></div>

                                <!-- SECONDARY SOURCES -->
                                <xf:group class="fieldset">
                                    <xf:label>
                                        <h3>Secondary sources</h3>
                                    </xf:label>
                                    <xf:repeat ref="TEI:bibl[@type = 'auxiliary']" id="r-auxiliary">
                                        <xf:label/>
                                        <div class="row">
                                            <div class="col-xs-3">
                                                <div class="input-group">
                                                    <label class="input-group-addon glyphicon glyphicon-book" tooltip="ref"/>
                                                    <div>
                                                        <xf:input class="-input-group --form-control hidden" ref="TEI:ref/@target">
                                                            <xf:action ev:event="reference_autocomplete-callback">
                                                                <xf:setvalue ref="." value="event('termValue')"/>
                                                            </xf:action>
                                                            <xf:label class="input-group-addon -glyphicon -glyphicon-book">ref</xf:label>
                                                            <xf:hint>reference abbreviation</xf:hint>
                                                        </xf:input>
                                                        <input type="hidden" data-function="reference_autocomplete" placeholder="Type to search ..." autocomplete="off"/>
                                                    </div>
                                                </div>
                                                <xf:trigger class="hidden reference_autocomplete">
                                                    <xf:label/>
                                                    <xf:action ev:event="DOMActivate">
                                                        <xf:setvalue ref="instance('i-controller')/bibl" value="instance('i-default')//TEI:bibl[index('r-primarySource')]/TEI:ref/@target"/>
                                                        <xf:dispatch name="load-subform-event" targetid="load-subform-group"/>
                                                    </xf:action>
                                                </xf:trigger>
                                            </div>
                                            <div class="col-xs-3">
                                                <xf:input class="input-group -form-control" ref="TEI:author">
                                                    <xf:label class="input-group-addon">author</xf:label>
                                                </xf:input>
                                            </div>
                                            <div class="col-xs-2">
                                                <xf:input class="input-group -form-control" ref="TEI:seg[@type='details']">
                                                    <xf:label class="input-group-addon">details</xf:label>
                                                </xf:input>
                                            </div>
                                            <div class="col-xs-3">
                                                <xf:input class="input-group -form-control" ref="TEI:ptr/@ref">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-link">link</xf:label>
                                                </xf:input>
                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-3">
                                                <xf:select1 class="input-group -form-control" ref="@subtype">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-book"/>
                                                    <xf:itemset nodeset="instance('i-secondaryTypes')/option">
                                                        <xf:label ref="."/>
                                                        <xf:value ref="@value"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-8">
                                                <div class="input-group">
                                                    <xf:select class="input-group -form-control" ref="@ana" appearance="full">
                                                        <xf:label class="input-group-addon">source</xf:label>
                                                        <xf:itemset nodeset="instance('i-comments')//option">
                                                            <xf:label ref="."/>
                                                            <xf:value ref="@value"/>
                                                        </xf:itemset>
                                                    </xf:select>
                                                </div>
                                            </div>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                    <xf:label/>
                                                    <xf:delete nodeset="//TEI:bibl[@type = 'auxiliary'][index('r-auxiliary')]"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </xf:repeat>
                                    <div class="row">
                                        <div class="col-xs-11"/>
                                        <div class="col-xs-1">
                                            <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                                <xf:label/>
                                                <xf:insert context="//TEI:person" nodeset="TEI:bibl" origin="instance('i-template')//TEI:bibl[@type = 'auxiliary']"/>

                                            </xf:trigger>
                                        </div>
                                    </div>
                                </xf:group>
                            </xf:group>
                        </section>
                    </div>
                </div>
            </section>
            <!-- // end section names -->

            <!-- begin section relationships -->
            <section class="tp-section">
                <div class="tp-row">
                    <h2 class="tp-width-sidebar">Relationships</h2>
                    <div class="tp-width-main">
                        <xf:group ref="//TEI:listRelation"><!-- RELATIONSHIPS -->
                            <xf:group class="fieldset">
                                <xf:label/>

                                <xf:repeat ref="TEI:relation" id="r-relation">
                                    <xf:label/>
                                    <xf:group ref=".">
                                        <xf:label/>
                                        <div class="row">
                                            <div class="col-xs-2">
                                                <xf:select1 class="input-group -form-control" ref="@name">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tag"/>
                                                    <xf:itemset nodeset="instance('i-relationships')/option">
                                                        <xf:label ref="."/>
                                                        <xf:value ref="@value"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-2">
                                                <xf:select1 class="input-group -form-control" ref="@subtype">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-tag"/>
                                                    <xf:itemset nodeset="instance('i-relationshipTypes')/option">
                                                        <xf:label ref="."/>
                                                        <xf:value ref="@value"/>
                                                    </xf:itemset>
                                                </xf:select1>
                                            </div>
                                            <div class="col-xs-4">
                                                <div class="input-group">
                                                    <label class="input-group-addon glyphicon glyphicon-book" tooltip="ref"/>
                                                    <div>
                                                        <xf:input class="-input-group --form-control hidden" ref="@passive">
                                                            <xf:action ev:event="relatives_autocomplete-callback">
                                                                <xf:setvalue ref="." value="event('termValue')"/>
                                                            </xf:action>
                                                            <xf:label class="input-group-addon -glyphicon -glyphicon-book">ref</xf:label>
                                                            <xf:hint>relative</xf:hint>
                                                        </xf:input>
                                                        <input type="hidden" data-function="relatives_autocomplete" placeholder="Type to search ..." autocomplete="off"/>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xs-2">
                                                <xf:input class="-input-group --form-control" ref=".">
                                                    <xf:label class="input-group-addon glyphicon glyphicon-book"/>
                                                    <xf:hint>person</xf:hint>
                                                </xf:input>
                                            </div>
                                            <div class="col-xs-1">
                                                <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-trash">
                                                    <xf:label/>
                                                    <xf:delete nodeset="//TEI:relation[index('r-relation')]"/>
                                                </xf:trigger>
                                            </div>
                                        </div>
                                    </xf:group>
                                </xf:repeat>
                                <div class="row">
                                    <div class="col-xs-11"/>
                                    <div class="col-xs-1">
                                        <xf:trigger class="-btn -btn-default -glyphicon -glyphicon-plus">
                                            <xf:label/>
                                            <xf:insert context="//TEI:listRelation" nodeset="TEI:relation" origin="instance('i-template')//TEI:relation"/>
                                        </xf:trigger>
                                    </div>
                                </div>
                            </xf:group>
                        </xf:group>
                    </div>
                </div>
            </section>
            <!-- // end section relationships -->

            <section class="tp-section">
                <div class="tp-row">
                    <div class="tp-width-half">
                        <xf:submit class="-btn -btn-success -glyphicon -glyphicon-save" submission="s-save-data">
                            <xf:label>Save</xf:label>
                        </xf:submit>
                    </div>
                    <div class="tp-width-half">
                        <a href="browse.html" class="btn btn-default glyphicon glyphicon-out">Return to the list of names without saving</a>
                    </div>
                </div>
            </section>

        </main>
        <bfc:dialog id="bibl" src="bibl.html">
            <xf:label>Add bibl</xf:label>
            <div id="mountpoint"/>
        </bfc:dialog>
        <bfc:dialog id="place" src="place.html">
            <xf:label>Add place</xf:label>
            <div id="mountpointPlace"/>
        </bfc:dialog>
        <script type="text/javascript" src="resources/js/jquery-1.10.2.min.js"/>
        <script type="text/javascript" src="$shared/resources/scripts/loadsource.js"/>
        <script type="text/javascript" src="resources/js/bootstrap-3.4.4.min.js"/>
        <script src="$shared/resources/scripts/jquery/jquery-ui.min.js" type="text/javascript" charset="utf-8"/>
        <script type="text/javascript" src="resources/js/editor.js"/>
        <script type="text/javascript" src="resources/js/vendor/select2/select2.js"/>
        <script type="text/javascript" src="resources/js/select2/select2.js"/>
    </body>
</html>
